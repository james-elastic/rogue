#include <stdio.h>

#include "controller.h"
#include "error.h"

Joystick::Joystick() {
  // Init
}

Joystick::~Joystick() {
  // Free
  this->free();
}

void Joystick::InitJoysticks() {
  int maxJoysticks = this->MAX_JOYSTICKS;
  int numJoysticks = this->NumJoysticks();
  
  if(numJoysticks < maxJoysticks) {
    maxJoysticks = numJoysticks;
  }
  
  for(int i = 0; i < maxJoysticks; ++i) {
    joystick[i] = SDL_JoystickOpen( i );
    if(joystick[i] == NULL) {
      Error::Log(SDL_GetError());
      //SDL_LogError(SDL_LOG_CATEGORY_ERROR, "%s", SDL_GetError());
    }
  }
}

int Joystick::NumJoysticks() {
  return SDL_NumJoysticks();
}

void Joystick::free() {
  for(int i = 0; i < this->MAX_JOYSTICKS; ++i) {
    if(this->joystick[i] != NULL) {
      SDL_JoystickClose( joystick[i] );
      joystick[i] = NULL;
    }
  }
}
